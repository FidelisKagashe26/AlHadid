{% load static %}
<!DOCTYPE html>
<html lang="en" class="h-full" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Forgot Password — Al-Hadid</title>
  <link rel="stylesheet" href="{% static 'css/tw.css' %}">
  <style>
    /* ---------- Reusable effects (same feel as Login) ---------- */
    .logo-pulse { animation: pulse-subtle 2s ease-in-out infinite; }
    @keyframes pulse-subtle { 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.02);opacity:.95} }
    .card-entrance { animation: slideUp .6s ease-out; }
    @keyframes slideUp { from{opacity:0;transform:translateY(20px)} to{opacity:1;transform:translateY(0)} }

    .glassmorphism {
      background: rgba(255,255,255,.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid rgba(255,255,255,.2);
    }
    .dark .glassmorphism {
      background: rgba(15,23,42,.8);
      border: 1px solid rgba(255,255,255,.1);
    }

    .floating-particles { position:absolute; inset:0; overflow:hidden; pointer-events:none; }
    .particle {
      position:absolute; width:6px; height:6px; background: rgba(255,255,255,.12);
      border-radius:50%; animation: float 6s ease-in-out infinite, bubbleGlow 3s ease-in-out infinite alternate;
    }
    @keyframes float { 0%,100%{ transform:translateY(0) rotate(0); opacity:.55 } 50%{ transform:translateY(-22px) rotate(180deg); opacity:1 } }
    @keyframes bubbleGlow { 0%{ filter: drop-shadow(0 0 0 rgba(255,255,255,.0)); } 100%{ filter: drop-shadow(0 0 8px rgba(255,255,255,.25)); } }

    /* ---------- Floating label helpers (improved) ---------- */
    .floating-group { position: relative; }
    .floating-input { padding-top: 1.25rem; height: 3rem; }
    .floating-label {
      position: absolute;
      left: 1rem;
      top: 50%;
      transform: translateY(-50%);
      font-size: 0.95rem;
      line-height: 1rem;
      color: rgb(100 116 139);
      pointer-events: none;
      transition: all .16s ease;
      background: transparent;
      padding: 0 .25rem;
    }

    /* adjacent sibling selector — label must come right after input */
    .floating-input:focus + .floating-label,
    .floating-input:not(:placeholder-shown) + .floating-label {
      top: .35rem;
      transform: translateY(0);
      font-size: .75rem;
      color: rgb(16 185 129);
    }
    .dark .floating-label { color: rgb(148 163 184); }
    .dark .floating-input:focus + .floating-label,
    .dark .floating-input:not(:placeholder-shown) + .floating-label { color: rgb(52 211 153); }

    /* ---------- Toasts (floating messages) ---------- */
    @keyframes toastIn { from { opacity:0; transform: translateY(-8px); } to { opacity:1; transform: translateY(0); } }
    .toast { animation: toastIn .35s ease-out; }

    /* Alerts (Tailwind @apply for color skins) */
    .alert{ @apply rounded-xl border px-3 py-2 text-sm shadow-lg; }
    .alert-success{ @apply text-emerald-700 dark:text-emerald-200 bg-emerald-50 dark:bg-emerald-900/30 border-emerald-200 dark:border-emerald-800; }
    .alert-error{ @apply text-rose-700 dark:text-rose-200 bg-rose-50 dark:bg-rose-900/30 border-rose-200 dark:border-rose-800; }
    .alert-warning{ @apply text-amber-700 dark:text-amber-200 bg-amber-50 dark:bg-amber-900/30 border-amber-200 dark:border-amber-800; }
    .alert-info{ @apply text-sky-700 dark:text-sky-200 bg-sky-50 dark:bg-sky-900/30 border-sky-200 dark:border-sky-800; }

    /* Inputs & buttons (Tailwind @apply) */
    .input{
      @apply w-full rounded-xl border-2 border-slate-300 dark:border-slate-700
             bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100
             placeholder-slate-400 dark:placeholder-slate-500
             px-4 py-2.5 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition;
    }
    .btn{ @apply inline-flex items-center justify-center rounded-xl px-4 py-2 font-semibold transition; }
    .btn-primary{ @apply bg-emerald-600 hover:bg-emerald-700 active:bg-emerald-800 text-white shadow-sm; }
  </style>
</head>
<body class="h-full bg-gradient-to-br from-emerald-700 to-slate-900 dark:from-slate-950 dark:to-slate-900 relative">
  <!-- Floating particles background -->
  <div class="floating-particles" aria-hidden="true">
    <div class="particle" style="left: 10%; bottom: 12%; animation-delay: 0s;"></div>
    <div class="particle" style="left: 22%; bottom: 18%; animation-delay: .8s;"></div>
    <div class="particle" style="left: 35%; bottom: 10%; animation-delay: 1.6s;"></div>
    <div class="particle" style="left: 48%; bottom: 20%; animation-delay: .4s;"></div>
    <div class="particle" style="left: 60%; bottom: 14%; animation-delay: 1.2s;"></div>
    <div class="particle" style="left: 72%; bottom: 22%; animation-delay: .2s;"></div>
    <div class="particle" style="left: 84%; bottom: 16%; animation-delay: 1.4s;"></div>
  </div>

  <!-- Floating TOAST messages (top-center) -->
  {% if messages %}
  <div id="toast-stack" class="fixed top-4 left-1/2 -translate-x-1/2 z-50 w-[min(92vw,28rem)] space-y-2" aria-live="polite">
    {% for message in messages %}
      <div class="toast alert
        {% if message.tags == 'success' %} alert-success {% endif %}
        {% if message.tags == 'error' %} alert-error {% endif %}
        {% if message.tags == 'warning' %} alert-warning {% endif %}
        {% if message.tags == 'info' %} alert-info {% endif %}
      ">
        <div class="flex items-start gap-3">
          <div class="flex-1">{{ message }}</div>
          <button type="button" class="toast-close -m-1 rounded-lg px-2 text-slate-500 hover:text-slate-800 dark:text-slate-300 dark:hover:text-white" aria-label="Dismiss">✕</button>
        </div>
      </div>
    {% endfor %}
  </div>
  {% endif %}

  <main class="min-h-screen flex items-center justify-center p-4 relative z-10">
    <section class="w-full max-w-md glassmorphism rounded-2xl shadow-2xl card-entrance" aria-labelledby="forgot-title">
      <header class="px-8 pt-8 pb-4 text-center">
        <img src="{% static 'images/logo.png' %}" alt="Al-Hadid" class="mx-auto h-16 w-auto mb-4 logo-pulse" />
        <h1 id="forgot-title" class="text-2xl font-semibold text-slate-100 tracking-tight">Forgot Password</h1>
        <p class="text-sm text-emerald-50/90 mt-1 font-medium">Al-Hadid Foundation</p>
      </header>

      <div class="px-8 pb-8">
        <p class="text-sm text-slate-700 dark:text-slate-300 mb-4 text-center">
          Enter your account email. We’ll send you a link to reset your password.
        </p>

        <form method="post" class="space-y-5" novalidate aria-describedby="email-help">
          {% csrf_token %}
          {% if form.email.errors %}
            <p class="mb-2 text-xs font-semibold" style="color: red;">
              {{ form.email.errors|striptags }}
            </p>
          {% endif %}
          <!-- Floating label email — corrected (no comments inside tag) -->
          <div class="floating-group mb-2">
            <input
              id="email"
              name="email"
              type="email"
              required
              autocomplete="email"
              placeholder=" "
              class="floating-input block w-full h-12 rounded-xl border-2 border-slate-300 dark:border-slate-700 bg-white dark:bg-slate-900 text-slate-900 dark:text-slate-100 px-4 pt-6 pb-2 placeholder-transparent focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition"
              aria-label="Email address"
            />
            <label for="email" class="floating-label">Email address</label>
          </div>

          <button class="btn btn-primary w-full" type="submit">Send Reset Link</button>

        </form>

        <div class="mt-6 text-center">
          <a href="{% url 'admin_panel:login' %}"
             class="text-sm text-slate-200/90 hover:text-white underline-offset-4 hover:underline">
            ← Back to Sign In
          </a>
        </div>
      </div>
    </section>
  </main>

  <script>
    // Persist dark mode + smooth background transition
    (function () {
      const saved = localStorage.getItem('theme');
      if (saved === 'dark') document.documentElement.classList.add('dark');
      document.documentElement.style.transition = 'background-color .3s ease';
    })();

    // Focus email after paint
    window.requestAnimationFrame(() => {
      const email = document.getElementById('email');
      if (email && (!document.activeElement || document.activeElement === document.body)) {
        email.focus();
      }
    });

    // Toast auto-dismiss + manual close
    (function () {
      const stack = document.getElementById('toast-stack');
      if (!stack) return;

      stack.querySelectorAll('.toast').forEach((t, i) => {
        const timeout = 4000 + i * 800;
        const timer = setTimeout(() => t.remove(), timeout);
        t.addEventListener('click', (e) => {
          if (e.target.closest('.toast-close')) {
            clearTimeout(timer);
            t.remove();
          }
        });
      });
    })();
  </script>
</body>
</html>
